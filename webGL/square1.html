<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>

<script src="js/three-min.js"></script>
<style type="text/css">
div#canvas-frame{
  border: none;
  cursor: pointer;
  width: 600px;
  height: 600px;
  background-color: #EEEEEE;
}
</style>
<script>
	var width, height;
	var renderer;
	function initThree() {
		width = document.getElementById('canvas-frame').clientWidth;
		height = document.getElementById('canvas-frame').clientHeight;
		renderer = new THREE.WebGLRenderer({antialias: true});
		renderer.setSize(width, height );
		document.getElementById('canvas-frame').appendChild(renderer.domElement);
		renderer.setClearColorHex(0xFFFFFF, 1.0);
		renderer.shadowMapEnabled = true;
	}
	
	var camera;
	function initCamera() {
		camera = new THREE.PerspectiveCamera( 45 , width / height , 1 , 10000 );
		camera.position.x = 700;
		camera.position.y = 50;
		camera.position.z = 300;
		camera.up.x = 0;
		camera.up.y = 0;
		camera.up.z = 1;
		camera.lookAt( {x:0, y:0, z:0 } );
	}
	
	var scene;
	function initScene() {
		scene = new THREE.Scene();
	}
	
	var light;
	function initLight() {
		light = new THREE.DirectionalLight(0xFFFFFF, 1.0, 0);
		light.position.set( 50, 50, 200 );
		scene.add(light);
		
		light.castShadow = true;
		
		light2 = new THREE.AmbientLight(0x555555);
		scene.add(light2);
	}
	
	var cube = Array();
	var plane;
	function initObject(){
		for(var i=0; i<3; i++){
		  cube[i] = new THREE.Mesh(
			   new THREE.CubeGeometry(50,50,50),
			   new THREE.MeshLambertMaterial({color: 0xff0000, ambient:0xFF0000})
		  );
		  cube[i].castShadow = true;
		  scene.add(cube[i]);
		  cube[i].position.set(0,-100+100*i,0);
		}
		for(;i<5; i++){
			cube[i] = new THREE.Mesh(
				 new THREE.CubeGeometry(50,50,50),
				 new THREE.MeshLambertMaterial({color: 0xff0000, ambient:0xFF0000})
			);
			cube[i].castShadow = true;
			scene.add(cube[i]);
			cube[i].position.set(0,-50+100*(i-3),50);
		}
		cube[i] = new THREE.Mesh(
			 new THREE.CubeGeometry(50,50,50),
			 new THREE.MeshLambertMaterial({color: 0xff0000, ambient:0xFF0000})
		);
		cube[i].castShadow = true;
		scene.add(cube[i]);
		cube[i].position.set(0,0,100);
		i++;
		
		for(;i<8; i++){
			cube[i] = new THREE.Mesh(
				 new THREE.CubeGeometry(50,50,50),
				 new THREE.MeshLambertMaterial({color: 0xff0000, ambient:0xFF0000})
			);
			cube[i].castShadow = true;
			scene.add(cube[i]);
			cube[i].position.set(0,-50+100*(i-6),150);
		}
		
		for(;i<10; i++){
			cube[i] = new THREE.Mesh(
				 new THREE.CubeGeometry(50,50,50),
				 new THREE.MeshLambertMaterial({color: 0xff0000, ambient:0xFF0000})
			);
			cube[i].castShadow = true;
			scene.add(cube[i]);
			cube[i].position.set(-50+100*(i-8),-50+100*(i-8),0);
		}
		
		for(;i<12; i++){
			cube[i] = new THREE.Mesh(
				 new THREE.CubeGeometry(50,50,50),
				 new THREE.MeshLambertMaterial({color: 0xff0000, ambient:0xFF0000})
			);
			cube[i].castShadow = true;
			scene.add(cube[i]);
			cube[i].position.set(50-100*(i-10),-50+100*(i-10),0);
		}
		
		plane = new THREE.Mesh(
			new THREE.PlaneGeometry(500, 500),               
			new THREE.MeshLambertMaterial({color: 0x999999, ambient:0x999999})
		);
		plane.receiveShadow = true;
		scene.add(plane);
		plane.position.set(0,0,-100);
	}
	
	var t=0;
	function loop() {
		t++;
		renderer.clear();
		cube[0].rotation.set( t/100, t/100, t/100 );
		cube[1].rotation.set( 0, t/100, 0 );
		cube[2].rotation.set( 0, 0, t/100 );
		cube[3].rotation.set( t/100, 0, 0 );
		cube[4].rotation.set( 0, t/100, 0 );
		cube[5].rotation.set( 0, 0, t/100 );
		cube[6].rotation.set( t/100, 0, 0 );
		cube[7].rotation.set( 0, t/100, 0 );
		camera.lookAt( {x:0, y:0, z:0 } );
		renderer.render(scene, camera);
		window.requestAnimationFrame(loop);
	}
	
	var down = false;
	var sy = 0, sz = 0;
	window.onmousedown = function (ev){
		if (ev.target == renderer.domElement) {
			down = true;
			sy = ev.clientX; sz = ev.clientY;
		}
	};
	
	window.onmouseup = function(){
		down = false;
	};
	
	window.onmousemove = function(ev) {
		var speed = 2;
		if (down) {
			if (ev.target == renderer.domElement) {
				var dy = -(ev.clientX - sy);
				var dz = -(ev.clientY - sz);
				camera.position.y += dy*speed;
				camera.position.z -= dz*speed;
				sy -= dy;
				sz -= dz;
			}
		}
	};
	
	window.onmousewheel = function(ev){
		var speed = 0.2;
		camera.position.x += ev.wheelDelta * speed ;
	};
	
	function threeStart() {
		initThree();
		initCamera();
		initScene();
		initLight();
		initObject();
		loop();
	}
</script>
</head>

<body onload="threeStart();">
	<div id="canvas-frame"></div>
</body>
</html>
